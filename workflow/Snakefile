from snakemake.utils import min_version
min_version("6.0")

configfile: "config/config.yaml"

from glob import glob
# brain_samples = [os.path.basename(folder) for folder in glob(os.path.join('data/original/ST/visium_data_{0}/'.format('brain'), '*'))]
# heart_samples = [os.path.basename(folder) for folder in glob(os.path.join('data/original/ST/visium_data_{0}/'.format('heart'), '*'))]
rule all:
    input:
        expand('results/MO/{tissue}.h5mu', tissue = ['brain', 'heart']),
        expand('results/MO/{tissue}.h5mu', tissue = ['brain', 'heart']),
        expand('plots/Misty/brain/{view_type}_misty_overall.pdf', view_type = ['pathwayCT', 'celltype']),
        expand('plots/Misty/{tissue}/functional_misty_overall.pdf', tissue = ['brain', 'heart'])


module general:
    snakefile: "rules/general.smk"
    config: config

use rule * from general

module celloracle:
    snakefile: "rules/celloracle.smk"
    config: config

use rule * from celloracle

module preprocessing:
    snakefile: "rules/preprocessing.smk"
    config: config

use rule * from preprocessing as PP_*

module functional:
    snakefile: "rules/functional.smk"
    config: config

use rule * from functional as fun_*

module misty:
    snakefile: "rules/misty.smk"
    config: config

use rule * from misty as misty_*

# snakemake --profile config/slurm/ celloracle
# conda env update --file local.yml --prune
